window.addEventListener("load",function(){XSTEP=(MaxX()-MinX())/Width,Draw()});let parsedExpression,F,XSTEP,PdfCanvas=document.getElementById("download-canvas"),CtxPdf=PdfCanvas.getContext("2d"),Canvas=document.getElementById("graph-canvas"),Ctx=Canvas.getContext("2d"),pdfXMargin=10,pdfYMargin=0,xtraTopMargin=-10,Width=Canvas.width,Height=Canvas.height,miny=-10,maxy=10,maxx=12,minx=-12,maxz=1.5,minz=-1.2,y=0,YSTEP=1,totalIndex=0,materialThickness=4,plotWidth=400,plotHeight=320,plotLayerOffset=5,plotLayerOffsetX=2.5,plotLayerOffsetY=7,lastTab=2,lastGradient=0,white_gradient=GradientGenerator.createGradient(["#ffffff","#ffffff","#ffffff"]),viridis_gradient=GradientGenerator.createGradient(["#440154","#482475","#414487","#355f8d","#2a788e","#21908d","#22a884","#42be71","#7ad151","#bddf26","#bddf26"]),magma_gradient=GradientGenerator.createGradient(["#000004","#140e36","#3b0f70","#641a80","#8c2981","#b5367a","#de4968","#f66e5c","#fe9f6d","#fecf92","#fecf92"]),megatron_gradient=GradientGenerator.createGradient(["#6e40aa","#be3caf","#fe4b83","#ff7747","#e3b62f","#b0ef5a","#53f666","#1edfa2","#23acd8","#4c6fdc","#4c6fdc"]),spectral_gradient=GradientGenerator.createGradient(["#9e0142","#d13b4b","#f0704a","#fcab63","#fedc8c","#fbf8b0","#e0f3a1","#aadda2","#69bda9","#4288b5","#4288b5"]),jShine_gradient=GradientGenerator.createGradient(["#12c2e9","#c471ed","#f64f59"]),gradients=[white_gradient,viridis_gradient,magma_gradient,megatron_gradient,spectral_gradient,jShine_gradient],mainGradient=gradients[0];function tabchange(t){tab1=document.getElementById("tab1"),tab2=document.getElementById("tab2"),tab1Con=document.getElementById("tab1Content"),tab2Con=document.getElementById("tab2Content"),1==t?(tab1.classList.add("active-tab"),tab1.classList.remove("inactive-tab"),tab2.classList.remove("active-tab"),tab2.classList.add("inactive-tab"),tab1Con.classList.add("hidden"),tab2Con.classList.remove("hidden")):(tab1.classList.remove("active-tab"),tab1.classList.add("inactive-tab"),tab2.classList.add("active-tab"),tab2.classList.remove("inactive-tab"),tab1Con.classList.remove("hidden"),tab2Con.classList.add("hidden"))}function chooseGradientUi(t){t!=lastGradient&&(checkmark=document.getElementById("checkmark"+t),oldcheckmark=document.getElementById("checkmark"+lastGradient),lastGradient=t,mainGradient=gradients[t],checkmark.classList.remove("opacity-0"),checkmark.classList.add("opacity-100"),oldcheckmark.classList.add("opacity-0"),oldcheckmark.classList.remove("opacity-100"),Draw())}function maxxRangeF(t){maxx=parseFloat(t)}function minxRangeF(t){minx=parseFloat(t)}function maxzRangeF(t){maxz=parseFloat(t)}function minzRangeF(t){minz=parseFloat(t)}function minyRangeF(t){miny=parseFloat(t),updateTotalLayers()}function maxyRangeF(t){maxy=parseFloat(t),updateTotalLayers()}function YStepInputF(t){YSTEP=parseFloat(t),updateTotalLayers()}function downloadPdf(){makePDF()}function changeY(t){y=parseFloat(t),plotLayerOffsetX=.5*t,Draw()}function updateTotalLayers(){document.getElementById("total-layers").innerHTML="Total layers: "+Math.floor((maxy-miny)/YSTEP+1)}function checkTotalLayers(){Math.floor((maxy-miny)/YSTEP+1)>101&&(showErrorMessage("tooMLayers"),YSTEP=(maxy-miny)/100),updateTotalLayers()}function checkFunctionHeight(t){for(let t=MinX();t<=MaxX();t+=XSTEP){let e=parsedExpression.evaluate({x:t,y:y});ZC(e)>Canvas.height-60?showErrorMessage("low"):ZC(e)<0&&showErrorMessage("high")}}function Draw(){hideErrorMessage();let t=document.getElementById("function-code").value.toLowerCase();try{parsedExpression=math.compile(t)}catch(t){showErrorMessage("fWriteErr")}checkTotalLayers(),checkFunctionHeight(F),Render3DFunction(F)}function Render3DFunction(t){var e=!0;let a;Ctx.fillStyle="#63B3ED",Ctx.fillRect(0,0,Canvas.width,Canvas.height);for(let t=miny;t<=maxy;t+=YSTEP){a=rangeNumbers(t,miny,maxy,-10,10),Ctx.fillStyle="black",Ctx.lineWidth=4,Ctx.beginPath();for(let n=MinX();n<=MaxX();n+=XSTEP){let i=parsedExpression.evaluate({x:n,y:t});e?(Ctx.moveTo(XC3D(n)+a*plotLayerOffsetX+.5*(Width-plotWidth),ZC3D(i)+a*plotLayerOffsetY+.5*(Height-plotHeight)+xtraTopMargin),e=!1):Ctx.lineTo(XC3D(n)+a*plotLayerOffsetX+.5*(Width-plotWidth),ZC3D(i)+a*plotLayerOffsetY+.5*(Height-plotHeight)+xtraTopMargin)}Ctx.lineTo(plotWidth-10+a*plotLayerOffsetX+.5*(Width-plotWidth),plotHeight-25+a*plotLayerOffsetY+.5*(Height-plotHeight)+xtraTopMargin),Ctx.lineTo(10+a*plotLayerOffsetX+.5*(Width-plotWidth),plotHeight-25+a*plotLayerOffsetY+.5*(Height-plotHeight)+xtraTopMargin),Ctx.closePath(),Ctx.stroke(),Ctx.fillStyle=mainGradient.getColorHexAt(mapRange(t,miny,maxy,0,1)),Ctx.fill()}}function PDFRenderFunction(t){var e=!0;CtxPdf.fillStyle="white",CtxPdf.fillRect(0,0,Canvas.width,Canvas.height),CtxPdf.fillStyle="black",CtxPdf.strokeStyle="black",CtxPdf.lineWidth=8,CtxPdf.beginPath();for(let t=MinX();t<=MaxX();t+=XSTEP){let a=parsedExpression.evaluate({x:t,y:y});e?(CtxPdf.moveTo(XC(t),ZC(a)),e=!1):CtxPdf.lineTo(XC(t),ZC(a))}CtxPdf.lineTo(Canvas.width-10,Canvas.height-10),CtxPdf.lineTo(10,Canvas.height-10),CtxPdf.closePath(),CtxPdf.stroke(),CtxPdf.fillStyle=mainGradient.getColorHexAt(mapRange(y,miny,maxy,0,1)),CtxPdf.fill(),CtxPdf.fillStyle="black";let a=mainGradient.getColorAt(mapRange(y,miny,maxy,0,1));76.245*a.r+149.685*a.g+29.07*a.b<=186&&(CtxPdf.fillStyle="white",CtxPdf.strokeStyle="white"),CtxPdf.beginPath(),CtxPdf.moveTo(Canvas.width/4,Canvas.height-10),CtxPdf.lineTo(Canvas.width/4,Canvas.height-50),CtxPdf.moveTo(Canvas.width/4*3,Canvas.height-10),CtxPdf.lineTo(Canvas.width/4*3,Canvas.height-50),CtxPdf.stroke(),CtxPdf.font="24px Roboto",CtxPdf.fillText("y="+y.toFixed(2),210,340),CtxPdf.fillStyle="black"}function renderSetup(){Canvas.width;CtxPdf.fillStyle="white",CtxPdf.fillRect(0,0,Canvas.width,Canvas.height),CtxPdf.fillStyle="black",CtxPdf.lineWidth=3,CtxPdf.beginPath(),CtxPdf.rect(10,10,150,15*(totalIndex+1));for(let t=0;t<=totalIndex;t++)CtxPdf.moveTo(10,15*(t+1)+10),CtxPdf.lineTo(60,15*(t+1)+10);CtxPdf.rect(190,10,150,15*(totalIndex+1));for(let t=0;t<=totalIndex;t++)CtxPdf.moveTo(190,15*(t+1)+10),CtxPdf.lineTo(240,15*(t+1)+10);CtxPdf.stroke()}function makePDF(){var t=new jsPDF;let e=0,a=0;totalIndex=0;for(let i=miny;i<=maxy;i+=YSTEP){y=i,PDFRenderFunction(F);var n=PdfCanvas.toDataURL("image/jpeg",1);totalIndex%2==0?(totalIndex%8==0&&0!=e&&(t.addPage(),e=0,a=0),t.addImage(n,"JPEG",pdfXMargin,pdfYMargin+PdfCanvas.height/5.5*e,PdfCanvas.width/5.5,PdfCanvas.height/5.5),e++):(t.addImage(n,"JPEG",pdfXMargin+PdfCanvas.width/5.5,pdfYMargin+PdfCanvas.height/5.5*a,PdfCanvas.width/5.5,PdfCanvas.height/5.5),a++),totalIndex++}renderSetup();n=PdfCanvas.toDataURL("image/jpeg",1);totalIndex%2==0?pdfYMargin+PdfCanvas.height/5.5*e+1+PdfCanvas.height/3.3<t.internal.pageSize.getHeight()?t.addImage(n,"JPEG",pdfXMargin,pdfYMargin+PdfCanvas.height/5.5*e+1,PdfCanvas.width/5.5,PdfCanvas.height/3.5):(t.addPage(),t.addImage(n,"JPEG",pdfXMargin,pdfYMargin+20,Canvas.width/5.5,Canvas.height/3.5)):pdfYMargin+PdfCanvas.height/5.5*a+PdfCanvas.height/3.3<t.internal.pageSize.getHeight()?t.addImage(n,"JPEG",pdfXMargin+PdfCanvas.width/5.5,pdfYMargin+PdfCanvas.height/5.5*a,PdfCanvas.width/5.5,PdfCanvas.height/3.5):(t.addPage(),t.addImage(n,"JPEG",pdfXMargin,pdfYMargin+20,PdfCanvas.width/5.5,PdfCanvas.height/3.5)),t.save("3d-Function-Paper-Cutout.pdf")}function showErrorMessage(t){let e=document.getElementById("err-msg");e.innerHTML="fWriteErr"==t?"The function you put in is not correct.":"low"==t?"The function you put in is too low. Make the minimum z higher":"high"==t?"The function you put in is too high. Make the maximum z higher":"tooMLayers"==t?"You can't have more than 101 layers":"Please change the parameters of your function.";let a=document.getElementById("error-message");a.classList.remove("hidden"),a.classList.add("block")}function hideErrorMessage(){let t=document.getElementById("error-message");t.classList.remove("block"),t.classList.add("hidden")}function premadeFunction(t,e,a,n,i,d,o,r){document.getElementById("function-code").value=t,maxxRangeF(e),maxzRangeF(a),minxRangeF(n),minzRangeF(i),minyRangeF(d),maxyRangeF(o),YStepInputF(r),Draw(),downloadPdf()}function MaxX(){return maxx}function MinX(){return minx}function MaxZ(){return maxz*Height/Width}function MinZ(){return minz*Height/Width}function XC(t){return(t-MinX())/(MaxX()-MinX())*(Width-20)+10}function ZC(t){return Height-(t-MinZ())/(MaxZ()-MinZ())*Height}function XC3D(t){return(t-MinX())/(MaxX()-MinX())*(plotWidth-20)+10}function ZC3D(t){return plotHeight-(t-MinZ())/(MaxZ()-MinZ())*plotHeight}function rangeNumbers(t,e,a,n,i){return(t-e)*(i-n)/(a-e)+n}function mapRange(t,e,a,n,i){return n+(t=(t-e)/(a-e))*(i-n)}window.onerror=function(t,e,a){this.showErrorMessage(t)},document.getElementById("premade-function-button-1").onclick=function(){premadeFunction("(sin(sqrt(x^2+y^2)))/(sqrt(x^2+y^2))",12,1.5,-12,-1.2,-10,10,1)},document.getElementById("premade-function-button-2").onclick=function(){premadeFunction("sin(x)*sin(y)",6.3,1.4,-3.1,-2,-3.1,6.3,.4)},document.getElementById("premade-function-button-3").onclick=function(){premadeFunction("7x y/e^(x^2 + y^2)",2.5,1.8,-2.5,-2.5,-2.5,2.5,.25)};
